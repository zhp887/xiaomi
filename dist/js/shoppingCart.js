"use strict";function getShoppingCar(e){var t=getCookie("userName");if(null!=t)$.get("./php/getShoppingCart.php",{vipName:t},function(t){var n='\n\t        \t<h2 id="spH2"><span>小米发货商品（不含有品）满99元免运费,还需</span><em>20元</em>  <a href="#">去凑单 ></a></h2>\n\t            <table class="shoppingCart_table">\n\t\t\t\t\t<tr class="shopping_xhx1">\n\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t<input id="input" type="checkbox" name="checkbox"/>\n\t\t\t\t\t\t\t<label  for="input"></label >\n\t\t\t\t\t\t\t<span>全选</span>\n\t\t\t\t\t\t</td>\n\t\t\t\t\t\t<td>编号</td>\n\t\t\t\t\t\t<td>商品名称</td>\n\t\t\t\t\t\t<td>单价</td>\n\t\t\t\t\t\t<td>数量</td>\n\t\t\t\t\t\t<td>小计</td>\n\t\t\t\t\t\t<td>操作</td>\n\t\t\t\t\t</tr>\n\t\t\t\t</table>\n\t        ';t.forEach(function(t){n+='\n\t                <table class="shoppingCart_table">\n\t\t\t\t\t\t<tr class="shopping_xhx">\n\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t<input id="input'.concat(t.goodsId,'" type="checkbox" name="checkbox"/>\n\t\t\t\t\t\t\t\t<label  for="input').concat(t.goodsId,'"></label >\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t <td class="goodsId">').concat(t.goodsId,'</td>\n\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t<a href="#"><img src="').concat(t.beiyong9,'"/></a>\n\t\t\t\t\t\t\t\t<a href="#">').concat(t.beiyong2,"  ").concat(t.beiyong5,"</a>\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t<td>").concat(t.goodsPrice,'</td>\n\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t<input type="button" class="reduceBtn" value="-" />\n\t\t\t\t\t\t\t\t<input type="text" class="wenBtn" value="').concat(t.goodsCount,'" />\n\t\t\t\t\t\t\t\t<input type="button" class="addBtn" value="+" />\n\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t<td>').concat(t.goodsPrice*t.goodsCount,'</td>\n\t\t\t\t\t\t\t<td><a class="delBtn">×</a></td>\n\t\t\t\t\t\t</tr>\n\t\t\t\t\t</table>\n\t            ')}),n+='\n\t                 <div class="shopping_jiesuan">\n\t\t\t\t\t\t<h3 class="float_left">\n\t\t\t\t\t\t\t<a href="#">继续购物 </a>\n\t\t\t\t\t\t\t<a>|</a>\n\t\t\t\t\t\t\t<a>共 <span id="shoppshu">0</span> 件商品，已选择<span>0</span>件</a>\n\t\t\t\t\t\t</h3>\n\t\t\t\t\t\t<h4 class="float_left">\n\t\t\t\t\t\t\t<span>合计</span>\n\t\t\t\t\t\t\t<em id="heji">0</em>\n\t\t\t\t\t\t\t<span>元</span>\n\t\t\t\t\t\t</h4>\n\t\t\t\t\t\t<input class="float_right" type="button" value="去结算" />\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="shangptj">\n\t\t\t\t\t\t<fieldset>\n\t\t\t\t\t\t\t<legend>买购物车中商品的人还买了</legend>\n\t\t\t\t\t\t</fieldset>\n\t\t\t\t\t</div>\n\t                ',$("#box").html(n),e()},"json");else{$("#box").html('\n\t    \t<div class="shopping_kgwc">\n\t\t\t\t<h2 class="float_left"><img src="images/kgwc_03.jpg"></h2>\n\t\t\t\t<div class="shopping_kc float_right">\n\t\t\t\t\t<h2>您的购物车还是空的！</h2>\n\t\t\t\t\t<h3>登录后将显示您之前加入的商品</h3>\n\t\t\t\t\t<h4><a href="login.html">立即登录</a><a href="productList.html">马上购物</a></h4>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="shangptj">\n\t\t\t\t<fieldset>\n\t\t\t\t\t<legend>为您推荐</legend>\n\t\t\t\t</fieldset>\n\t\t\t</div>\n    \t')}}function showWelcomeAndLogin(t){var n=getCookie("userName");if(null!=n){'\n        \t<a href="#" class="nav_a" id="userSpan"></a>\n\t\t\t<span>|</span>\n\t\t\t<a href="#">我的订单</a>\n\t\t\t<div class="nav_xlk">\n\t\t\t\t<ul>\n\t\t\t\t\t<li><a href="#">个人中心</a></li>\n\t\t\t\t\t<li><a href="#">评价晒单</a></li>\n\t\t\t\t\t<li><a href="#">我的喜欢</a></li>\n\t\t\t\t\t<li><a href="#">小米账户</a></li>\n\t\t\t\t\t<li><a href="#" id="btnLogout">退出登录</a></li>\n\t\t\t\t</ul>\n\t\t\t</div>\n        ',$("#nav_box").html('\n        \t<a href="#" class="nav_a" id="userSpan"></a>\n\t\t\t<span>|</span>\n\t\t\t<a href="#">我的订单</a>\n\t\t\t<div class="nav_xlk">\n\t\t\t\t<ul>\n\t\t\t\t\t<li><a href="#">个人中心</a></li>\n\t\t\t\t\t<li><a href="#">评价晒单</a></li>\n\t\t\t\t\t<li><a href="#">我的喜欢</a></li>\n\t\t\t\t\t<li><a href="#">小米账户</a></li>\n\t\t\t\t\t<li><a href="#" id="btnLogout">退出登录</a></li>\n\t\t\t\t</ul>\n\t\t\t</div>\n        '),$("#userSpan").html(n)}else{'\n        <a href="login.html">登录</a>\n\t\t<span>|</span>\n\t\t<a href="register.html">注册</a>\n        ',$("#nav_box").html('\n        <a href="login.html">登录</a>\n\t\t<span>|</span>\n\t\t<a href="register.html">注册</a>\n        '),getShoppingCar(addEvent)}t()}function updateCount(t,n,e){var a=getCookie("userName");null!=a&&$.get("./php/updateGoodsCount.php",{vipName:a,goodsId:t,goodsCount:n},function(t){"0"==t?alert("服务器出错：修改数量失败"):e()})}function addEvent(){$("table :checkbox:eq(0)").check($("table :checkbox:gt(0)")),$(":checkbox").click(function(){totalMoney()}),$(".addBtn").click(function(){var n=this,t=$(this).parent().parent().find(".goodsId").html(),e=$(this).prev().val();updateCount(t,++e,function(){$(n).prev().val(e);var t=$(n).parent().prev().html()*e;$(n).parent().next().html(t),totalMoney()})}),$(".wenBtn").blur(function(){var n=this,t=$(this).parent().parent().find(".goodsId").html(),e=$(this).val();updateCount(t,e,function(){$(n).val(e);var t=$(n).parent().prev().html()*e;$(n).parent().next().html(t),totalMoney()})}),$(".reduceBtn").click(function(){var n=this,t=$(this).parent().parent().find(".goodsId").html(),e=$(this).next().val();--e<1&&(e=0),updateCount(t,e,function(){$(n).next().val(e);var t=$(n).parent().prev().html()*e;$(n).parent().next().html(t),0==e&&$(n).parent().parent().find(":checkbox").prop("checked",!1),totalMoney()})}),$(".delBtn").click(function(){var t=$(this).parent().parent().find(".goodsId").html();confirm("亲，您真的要删除吗？")&&(deleteGoods(t),$(this).parent().parent().remove(),totalMoney())})}function deleteGoods(t){var n=getCookie("userName");$.get("php/deleteGoods.php",{vipName:n,goodsId:t},function(t){"0"==t&&alert("服务器出错：删除失败")})}function totalMoney(){var t=0;$(".shopping_xhx").each(function(){$(this).find(":checkbox").prop("checked")&&(t+=parseFloat($(this).find("td").eq(5).html()))}),$("#heji").html(t)}function fn(){$(".nav_xlk").mouseenter(function(){$(this).stop().slideDown(200)}).mouseleave(function(){$(this).stop().slideUp(200)}),$("#userSpan").mouseenter(function(){$(".nav_xlk").stop().slideDown(200)}),$("#userSpan").mouseleave(function(){$(".nav_xlk").stop().slideUp(200)})}$(function(){getShoppingCar(addEvent),showWelcomeAndLogin(fn),$("#btnLogout").click(function(){removeCookie("userName"),showWelcomeAndLogin()})});